<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div id="root">
<h1>Counter</h1>
    <div m-for="item in items">
        Item: {{ item }}
    </div>

    <div>
        <p>Ім'я: {{ user.name }}
        <p>Місто: {{ user.address.city }}
        <p>Повна адреса: {{ fullAddress }}
    </div>

    <div>
        <input type="text" data-model="user.name">
    </div>
    
    <div>Counter: {{ counter }}</div>
    <div><input class="text-center" type="text" data-model="counter"></div>
    <div>Статус: {{ status }}</div>
    <!-- Додаємо нові блоки з m-if -->
    <div m-if="counter > 0">
        Лічильник більший за нуль
    </div>
    <div m-if="counter < 0">
        Лічильник менший за нуль
    </div>
    <div m-if="counter === 0">
        Лічильник дорівнює нулю
    </div>

    <div class="m-2 d-flex flex-row gap-2">
        <button onclick="updateCounter('+')">+</button>
        <button onclick="updateCounter('-')">-</button>
        <button onclick="updateArray()">Upd Array</button>
    </div>
</div>
<script type="module">
    import Model from "../src/index.js";
    // Model.DEBUG = true;
    const app = new Model({
        items: ['Перший', 'Другий', 'Третій'],
        counter: 10,
        status: function () {
            return this.counter === 0 ? "Zero" : this.counter > 0 ? "Positive" : "Negative";
        },
        user: {
            name: 'Іван',
            address: {
                city: 'Київ',
                street: 'Хрещатик'
            }
        },
        // Computed властивість, що використовує вкладені дані
        fullAddress() {
            return `${this.user.address.city}, ${this.user.address.street}`;
        },
    })

    app.init("#root")

    globalThis.updateCounter = (operator) => {
        operator === "-" ? app.data.counter-- : app.data.counter++
    }

    globalThis.updateArray = () => {
        app.data.items.push('Новий елемент');
    }
    
    // Валідація
    // app.addValidator('username', value => value.length >= 3);

    // Форматування
    // app.addFormatter('username', value => value.trim());

    // Спостерігач
    // app.watch('counter', (newValue, oldValue) => {
    //     console.log(`Counter змінився з ${oldValue} на ${newValue}`);
    // });

    // Групове оновлення
    // app.batch(() => {
    //     app.data.counter = 10;
    //     app.data.username = 'John';
    // });

    // Збереження стану
    // window.addEventListener('beforeunload', () => {
    //     app.saveState();
    // });

    // Відновлення стану при завантаженні
    // document.addEventListener('DOMContentLoaded', () => {
    //     app.loadState();
    //     app.init();
    // });

</script>
</body>
</html>